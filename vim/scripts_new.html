---
layout: default
title: Scripts
---

/<input id="filter" type="text" style="border:none"/>

<table >
  <thead>
    <tr>
      <th scope="col">Type</th>
      <th scope="col">Name</th>
      <th scope="col" width="100%">Description</th>
    </tr>
  </thead>
  <tbody>

    <tr class="loading">
      <td colspan="4">loading scripts....</td>
    </tr>

  </tbody>

</table>

<script type="text/javascript">

  var Filter = new function() {

    var $ = jQuery;
    var $this = this;

    this.bind = function(input) {
      $(input).bind('keyup'  ,function(e) { onkeyup(e, filter); } )
    };

    var onkeyup = function(e, filter) {
      // TODO:
      $this.current = e.target.value
      setTimeout(function() { filter(e.target.value) }, 10)
    }

    var filter = function(match) {
      if (match == null || match == '' || match.lenght == 0) {
        $('table tbody tr').show()
      } else {

        $this.matches = [];

        for(var i = 0; i < vim_scripts.length; i++ ) {
          if ($this.current != match) break;
          var s = vim_scripts[i];
          var r = new RegExp(match.toLowerCase())
          if (s.n && r.test(s.n.toLowerCase())) {
            $this.matches.push(('tr[id="' + s.n +'"]'))
          }
        }

        $('table tbody tr').hide();
        $($this.matches.join(',')).show();
      }
    }
  };


  var vim_scripts = [];

  jQuery(function($) {

    $.ajax({
      type: "GET",
      url: "/api/scripts_recent.json",
      dataType: "json",
      success: function(data) { vim_scripts = data; render(0, data) },
    });

    var render = function(page, data) {
      var html = build_table(page, data);
      if (!html || html == '') {
        $('.loading').remove();
        Filter.bind(jQuery('#filter'));
        $('#filter').focus()
        return;
      };
      $('table tbody').append(html)
      setTimeout(function() { render(page + 1, data) }, 10)
    }

    var build_table = function(page, data) {
      var html = '';
      for(var i = 0; i < 300; i++ ) {
        var k = data.length - i - 1 - (page * 300)

        if (k < 0) return html;

        var s = data[ k ]

        html += '' +
        '<tr id="' + s.n + '">' +
        '<td>'+  s.t + '</td>' +
        '<td class="name">' + '<a href="http://github.com/vim-scripts/' + s.n + '">' + s.n + '</a></td>' +
        '<td>' + s.s + '</td>'
        '</tr>'
      }
      return html;
    }
  }); 
</script>
